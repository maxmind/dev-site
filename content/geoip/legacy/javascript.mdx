---
draft: false
title: GeoIP Legacy JavaScript
---

<Alert type="error">
  On October 31, 2017, we discontinued our legacy GeoIP JavaScript services,
  which used the endpoints `http://js.maxmind.com/js/country.js` and
  `http://js.maxmind.com/js/geoip.js`.

  Please upgrade your legacy GeoIP integration to use our [GeoIP2 JavaScript
  Client API](/geoip/geolocate-an-ip/client-side-javascript).
</Alert>


## What should you do?

There are several options available. The recommended option is to switch to
performing lookups on your server via an integration with our
[GeoIP2 Precision web services](/geoip/geolocate-an-ip/web-services). Another
option is to switch to using our [GeoIP2 downloadable databases](/geoip/geolocate-an-ip/databases).
Both of these options allow you to perform GeoIP2 lookups on your server rather
than in the browser.

You could also switch to using our [GeoIP2 JavaScript client](/geoip/geolocate-an-ip/client-side-javascript).
While this is the most direct equivalent to our legacy GeoIP JavaScript
services, we recommend that you use one of the server side integrations instead.
With server side integrations, lookups do not need to be performed in the
browser, so they are inherently more secure. Using a server side integration is
the most future proof option.

## Switching to our GeoIP2 JavaScript client
This section will show you how to convert a very simple website using our legacy
GeoIP JavaScript services to our new GeoIP2 JavaScript client.

We recommend that you have an experienced developer familiar with JavaScript
make such updates.

Before you make any updates, there are two key differences you should be aware
of:

  1. The data provided by our GeoIP2 services has some differences from our
  legacy GeoIP services. You can read more about the differences here.
  2. The biggest difference you will notice about our GeoIP2 JavaScript client
  is that you receive lookup results via callback functions rather than through
  direct function calls. This is a common pattern in JavaScript, but it means
  you may need to re-structure your code.

## An example legacy GeoIP JavaScript integration
Here is a very simple website that uses our legacy GeoIP JavaScript services to
show the city and country names of the visitor:

```html
<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>My example legacy GeoIP app</title>
        <script src="//js.maxmind.com/js/geoip.js" type="text/javascript"></script>
    </head>
    <body>
        Hi, I see you are from
        <script>document.write(geoip_city() || 'Unknown city');</script>,
        <script>document.write(geoip_country_name() || 'Unknown country');</script>!
    </body>
</html>
```

If you load this page, it would show something like this:
`Hi, I see you are from Vancouver, Canada!`

## Converting it to a GeoIP2 JavaScript integration
In order to convert this website to use our GeoIP2 JavaScript client, there are
two main things to do:

  1. You must switch the first `<script>` element’s `src` URL to our GeoIP2
  JavaScript file.
  2. You must use callback functions rather than direct function calls.

An easy way to switch to callback functions in the above example is to replace
the locations with `geoip_*()` function calls to have elements that you can
access and update from a JavaScript function. We can do this by changing the
last two `<script>` elements to be `<span>` elements with `id` attributes.

Once you have these elements, you can write your callback functions. The success
callback will have the results of the lookup. You can take these results and
update the elements with the information.

Here is how that would look:

```html
<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>My example GeoIP2 app (converted)</title>
        <script src="//geoip-js.com/js/apis/geoip2/v2.1/geoip2.js" type="text/javascript"></script>
        <script>
        var onSuccess = function(geoipResponse) {
            var cityElement = document.getElementById('city');
            if (cityElement) {
                cityElement.textContent = geoipResponse.city.names.en || 'Unknown city';
            }

            var countryElement = document.getElementById('country');
            if (countryElement) {
                countryElement.textContent = geoipResponse.country.names.en || 'Unknown country';
            }
        };

        var onError = function(error) {
            window.console.log("something went wrong: " + error.error)
        };

        var onLoad = function() {
            geoip2.city(onSuccess, onError);
        };

        // Run the lookup when the document is loaded and parsed. You could
        // also use something like $(document).ready(onLoad) if you use jQuery.
        document.addEventListener('DOMContentLoaded', onLoad);
        </script>
    </head>
    <body>
        Hi, I see you are from
        <span id="city"></span>,
        <span id="country"></span>!
    </body>
</html>
```

If you load this page, you will see the same text before.

## References and further reading
  * [GeoIP2 JavaScript client – Live Demo](https://www.maxmind.com/en/geoip2-javascript-demo)
  * [Geolocate and IP – Client-side JavaScript](/geoip/geolocate-an-ip/client-side-javascript)
  * [What's New in GeoIP2](/geoip/whats-new-in-geoip2)
